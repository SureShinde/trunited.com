<?xml version="1.0"?>
<layout version="0.1.0">
	<truwalletadmin_adminhtml_truwallet_index>
		<reference name="content">
			<block type="truwallet/adminhtml_truwallet" name="truwallet" />
		</reference>
	</truwalletadmin_adminhtml_truwallet_index>
	<truwalletadmin_adminhtml_customer_index>
		<reference name="content">
			<block type="truwallet/adminhtml_customer" name="truwallet.customer" />
		</reference>
	</truwalletadmin_adminhtml_customer_index>
	<truwalletadmin_adminhtml_transaction_index>
		<reference name="content">
			<block type="truwallet/adminhtml_transaction" name="truwallet.transaction" />
		</reference>
	</truwalletadmin_adminhtml_transaction_index>

	<adminhtml_customer_edit>
		<reference name="customer_edit_tabs">
			<action method="addTab">
				<name>truwallet_tab</name>
				<block>truwallet/adminhtml_customer_edit_tab_truwallet</block>
			</action>
		</reference>
	</adminhtml_customer_edit>
	<truwalletadmin_adminhtml_customer_grid>
		<block type="core/text_list" name="root" output="toHtml">
			<block type="truwallet/adminhtml_customer_edit_tab_history" name="truwallet_history" />
		</block>
	</truwalletadmin_adminhtml_customer_grid>

	<!-- SHOW DISCOUNT ORDER, INVOICE, PDF, EMAIL -->

	<adminhtml_sales_order_view>
		<reference name="order_totals">
			<block type="truwallet/order_totals" />
		</reference>
	</adminhtml_sales_order_view>

	<adminhtml_sales_order_invoice_new>
		<reference name="invoice_totals">
			<block type="truwallet/order_invoice_totals" />
		</reference>
	</adminhtml_sales_order_invoice_new>
	<adminhtml_sales_order_invoice_updateqty>
		<reference name="invoice_totals">
			<block type="truwallet/order_invoice_totals"/>
		</reference>
	</adminhtml_sales_order_invoice_updateqty>
	<adminhtml_sales_order_invoice_view>
		<reference name="invoice_totals">
			<block type="truwallet/order_invoice_totals" />
		</reference>
	</adminhtml_sales_order_invoice_view>

	<adminhtml_sales_order_invoice_print>
		<reference name="invoice_totals">
			<block type="truwallet/order_invoice_totals" />
		</reference>
	</adminhtml_sales_order_invoice_print>

	<adminhtml_sales_order_creditmemo_new>
		<reference name="creditmemo_totals">
			<block type="truwallet/order_creditmemo_totals" />
		</reference>
	</adminhtml_sales_order_creditmemo_new>
	<adminhtml_sales_order_creditmemo_updateqty>
		<reference name="creditmemo_totals">
			<block type="truwallet/order_creditmemo_totals" />
		</reference>
		<reference name="submit_before">
			<block type="truwallet/order_creditmemo_controls" name="truwallet.balance" template="truwallet/sales/creditmemo/refund.phtml" />
		</reference>
	</adminhtml_sales_order_creditmemo_updateqty>
	<adminhtml_sales_order_creditmemo_new>
		<reference name="submit_before">
			<block type="truwallet/order_creditmemo_controls" name="truwallet.balance" template="truwallet/sales/creditmemo/refund.phtml" />
		</reference>
	</adminhtml_sales_order_creditmemo_new>
	<adminhtml_sales_order_creditmemo_view>
		<reference name="creditmemo_totals">
			<block type="truwallet/order_creditmemo_totals" />
		</reference>
	</adminhtml_sales_order_creditmemo_view>

	<adminhtml_sales_order_create_index>
		<reference name="head">
			<action method="addItem">
				<type>skin_js</type>
				<name>js/magestore/truwallet.js</name>
				<params/>
			</action>
		</reference>
		<reference name="items_grid">
			<block type="truwallet/order_create_credit" template="truwallet/form.phtml" name="truwallet.using" />
		</reference>
	</adminhtml_sales_order_create_index>
	<adminhtml_sales_order_create_load_block_data>
		<reference name="items_grid">
			<block type="truwallet/order_create_credit" template="truwallet/form.phtml" name="truwallet.using" />
		</reference>
	</adminhtml_sales_order_create_load_block_data>
	<adminhtml_sales_order_create_load_block_items>
		<reference name="items_grid">
			<block type="truwallet/order_create_credit" template="truwallet/form.phtml" name="truwallet.using" />
		</reference>
	</adminhtml_sales_order_create_load_block_items>


	<sales_order_grid_update_handle>
		<reference name="sales_order.grid">
			<action method="addColumnAfter">
				<columnId>created_by</columnId>
				<arguments>
					<header>Created By Admin</header>
					<index>order.created_by</index>
					<filter>Magestore_TruBox_Block_Adminhtml_Sales_Order_Grid</filter>
					<type>options</type>
					<width>50</width>
					<renderer>Magestore_TruBox_Block_Adminhtml_Renderer_Sales_Order_Grid</renderer>
				</arguments>
				<after>grand_total</after>
			</action>
		</reference>
	</sales_order_grid_update_handle>
	<adminhtml_sales_order_grid>
		<update handle="sales_order_grid_update_handle" />
	</adminhtml_sales_order_grid>
	<adminhtml_sales_order_index>
		<update handle="sales_order_grid_update_handle" />
	</adminhtml_sales_order_index>
	<adminhtml_sales_order_view>
		<reference name="order_totals">
			<block type="truwallet/adminhtml_totals_order_point" name="truwallet.total.point" />
		</reference>
	</adminhtml_sales_order_view>

	<adminhtml_sales_order_creditmemo_new>
		<reference name="creditmemo_totals">
			<block type="truwallet/adminhtml_totals_creditmemo_point" name="truwallet.total.point" />
		</reference>
		<reference name="submit_before">
			<block type="truwallet/adminhtml_totals_creditmemo_rewards" name="truwallet.total.earned" template="truwallet/totals/creditmemo/rewards.phtml" />
		</reference>
	</adminhtml_sales_order_creditmemo_new>
	<adminhtml_sales_order_creditmemo_updateqty>
		<reference name="creditmemo_totals">
			<block type="truwallet/adminhtml_totals_creditmemo_point" name="truwallet.total.point" />
		</reference>
		<reference name="submit_before">
			<block type="truwallet/adminhtml_totals_creditmemo_rewards" name="truwallet.total.earned" template="truwallet/totals/creditmemo/rewards.phtml" />
		</reference>
	</adminhtml_sales_order_creditmemo_updateqty>
	<adminhtml_sales_order_creditmemo_view>
		<reference name="creditmemo_totals">
			<block type="truwallet/adminhtml_totals_creditmemo_point" name="truwallet.total.point" />
		</reference>
	</adminhtml_sales_order_creditmemo_view>

</layout>
